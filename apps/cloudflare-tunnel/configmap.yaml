apiVersion: v1
kind: ConfigMap
metadata:
  name: cloudflare-tunnel-config
  namespace: cloudflare-tunnel
data:
  config.yaml: |
    tunnel: bbe4d352-a6f1-4cec-9070-1e609897ff0f
    credentials-file: /etc/cloudflared/credentials.json
    metrics: 0.0.0.0:2000
    no-autoupdate: true
    loglevel: info
    protocol: auto

    originRequest:
      noTLSVerify: false
      connectTimeout: 30s
      keepAliveConnections: 100
      keepAliveTimeout: 90s
      http2Origin: true

    ingress:
      - hostname: "*.froystein.jp"
        service: http://envoy-envoy-gateway-system-eg-public-7b646a69.envoy-gateway-system.svc.cluster.local:80
      - hostname: "froystein.jp"
        service: http://envoy-envoy-gateway-system-eg-public-7b646a69.envoy-gateway-system.svc.cluster.local:80
      # Catch-all rule (required by cloudflared)
      - service: http_status:404
